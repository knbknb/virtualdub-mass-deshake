// VirtualDub Script (Sylia script format)


declare numFrames;
numFrames = VirtualDub.params[0];
numFrames=Sylia.Atoi(numFrames);

declare infile;
infile = VirtualDub.params[1];

declare outfile;
outfile = VirtualDub.params[2];

//declare showOutputWindow;
//showOutputWindow = VirtualDub.params[3];
//showOutputWindowInt = Sylia.Atoi(showOutputWindow);

//these will be converted to ints later
declare brightness;
brightness="48";
declare contrast;
contrast="16";
declare sharpen;
sharpen="24";


declare width;
width="1280";
declare height;
height="720";

VirtualDub.Open(infile,"",0);
VirtualDub.audio.SetSource(1);
VirtualDub.audio.SetMode(0);
VirtualDub.audio.SetInterleave(1,500,1,0,0);
VirtualDub.audio.SetClipMode(1,1);
VirtualDub.audio.SetEditMode(1);
VirtualDub.audio.SetConversion(0,0,0,0,0);
VirtualDub.audio.SetVolume();
VirtualDub.audio.SetCompression();
VirtualDub.audio.EnableFilterGraph(0);
VirtualDub.video.SetInputFormat(0);
VirtualDub.video.SetOutputFormat(7);
VirtualDub.video.SetMode(3);
VirtualDub.video.SetSmartRendering(0);
VirtualDub.video.SetPreserveEmptyFrames(0);
VirtualDub.video.SetFrameRate2(0,0,1);
VirtualDub.video.SetIVTC(0, 0, 0, 0);
//knb
VirtualDub.video.SetCompression(0x53444646,0,10000,0);
VirtualDub.video.SetCompData(2404,"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");
VirtualDub.video.filters.Clear();
VirtualDub.video.filters.Add("Deshaker v3.0");
VirtualDub.video.filters.instance[0].Config("18|1|30|4|1|0|1|0|" + width + "|" + height + "|1|2|400|400|400|1500|4|1|4|2|5|40|300|4|C:\\Deshaker.log|0|0|0|0|0|0|0|0|0|0|0|0|0|1|15|15|5|15|0|0|30|30|0|0|1|0|1|0|0|10|1000|1|59|1|1|20|1500|100|20|0");
VirtualDub.RunNullVideoPass();
//knb
VirtualDub.video.SetCompression(0x44495658,0,10000,0);
VirtualDub.video.SetCompData(3540,"AgAAAIA+AACQsggAQzpcdmlkZW8ucGFzcwBveFx2aWRlby5wYXNzAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAZAAAAEhpZ2hkZWYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAEdlbmVyYWwgcHVycG9zZQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAIERITFRcZGxESExUXGRscFBUWFxgaHB4VFhcYGhweIBYXGBocHiAjFxgaHB4gIyYZGhweICMmKRscHiAjJiktEBESExQVFhcREhMUFRYXGBITFBUWFxgZExQVFhcYGhsUFRYXGRobHBUWFxgaGxweFhcYGhscHh8XGBkbHB4fIQAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAIAAACWAAAAZAAAAAEAAAAAAAAABAAAAAMAAAABAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAZAAAAPQBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAABkAAAAZAAAAAEAAAAKAAAAAQAAABQAAAAAAAAAAAAAAAUAAAAFAAAABQAAAAAoCgAAAAAAAQAAAAEAAAAeAAAAAAAAAAIAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAYAAAABAAAAAAAAAAEAAAAAAAAALAEAAAAAAAABAAAAHwAAAAEAAAAfAAAAAQAAAB8AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAABBAAAA");
VirtualDub.video.filters.Clear();
VirtualDub.video.filters.Add("Deshaker v3.0");
VirtualDub.video.filters.instance[0].Config("18|2|30|4|1|0|1|0|" + width + "|" + height + "|1|2|400|400|400|1500|4|1|0|2|5|40|300|4|C:\\Deshaker.log|0|0|0|0|0|0|0|0|0|0|0|0|0|1|15|15|5|15|1|1|30|30|0|0|1|0|1|0|0|10|1000|1|59|1|1|20|1500|100|20|1");
VirtualDub.video.filters.Add("brightness/contrast");
VirtualDub.video.filters.instance[1].Config(Sylia.Atoi(brightness),Sylia.Atoi(contrast));
VirtualDub.video.filters.Add("sharpen");
VirtualDub.video.filters.instance[2].Config(Sylia.Atoi(sharpen));
VirtualDub.audio.filters.Clear();
VirtualDub.subset.Clear();
VirtualDub.subset.AddRange(0,numFrames);
VirtualDub.video.SetRange();
VirtualDub.project.ClearTextInfo();
VirtualDub.project.AddTextInfo("ISFT", "copyright Knut Behrends 2014. All rights reserved");
  // -- $reloadstop --
VirtualDub.SaveAVI(outfile);
VirtualDub.audio.SetSource(1);
VirtualDub.Close();

// $endjob
//
//--------------------------------------------------
// $done
